# Tests

Эта директория содержит автоматизированные тесты для проверки функциональности приложения.

## Файлы

- `ws_test.py` - Простой тест WebSocket соединения
  - Проверяет подключение к WebSocket серверу
  - Отправляет тестовые бинарные данные (10 байт)
  - Проверяет получение ответа
  - Минимальный тест для быстрой проверки

- `test_websocket_detailed.py` - Подробный тест WebSocket соединения
  - Проверяет подключение к WebSocket серверу
  - Отправляет тестовые аудио данные
  - Проверяет получение ответов с таймаутами
  - Ждет дополнительные сообщения
  - Подробное логирование и обработка ошибок

- `test_worker_integration.py` - Тест интеграции воркера
  - Проверяет полный цикл: WebSocket -> Redis -> Worker -> Transcript
  - Отправляет аудио данные через WebSocket
  - Ждет транскрипт от воркера
  - Проверяет корректность полученных данных

- `test_validation.py` - Тест валидации и обработки ошибок
  - Проверяет валидацию пустых данных
  - Проверяет валидацию слишком больших данных (>1MB)
  - Проверяет обработку корректных данных
  - Проверяет получение транскриптов с правильным статусом

- `test_validation_simple.py` - Упрощенный тест валидации
  - Работает локально без внешних зависимостей
  - Тестирует логику валидации данных

- `test_integration.py` - Интеграционные тесты
  - Тест с одним клиентом
  - Тест с несколькими клиентами одновременно
  - Тест обработки ошибок
  - Тест интеграции с воркером

- `test_load.py` - Нагрузочное тестирование
  - Тестирует устойчивость при параллельных соединениях
  - Измеряет производительность системы
  - Проверяет обработку множественных клиентов

## Запуск тестов

```bash
# Установка зависимостей
pip install websockets

# Быстрый тест
python3 tests/ws_test.py

# Подробный тест
python3 tests/test_websocket_detailed.py

# Тест интеграции воркера
python3 tests/test_worker_integration.py

# Тест валидации и обработки ошибок
python3 tests/test_validation.py

# Упрощенный тест валидации
python3 tests/test_validation_simple.py

# Интеграционные тесты
python3 tests/test_integration.py

# Нагрузочное тестирование
python3 tests/test_load.py

# Стресс-тестирование
python3 tests/test_load.py stress
```

## Требования

- Python 3.7+
- websockets библиотека
- Запущенный WebSocket сервер (docker-compose up) 